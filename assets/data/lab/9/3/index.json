{"hash":"cbc5ce0b2c12ca499ebc2ea60d5c6fbc9fc54790","data":{"labInstructions":{"id":"9-3","step":3,"lab":9,"title":"Lab 9","content":"<h1 id=\"create-a-sketchbook-canvas-for-the-user\"><a href=\"#create-a-sketchbook-canvas-for-the-user\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Create a Sketchbook canvas for the user.</h1>\n<p>Open the sketchbook.html file, the html should already be setup for you. You will need to make sure the Firebase scripts and the Konva scripts are loaded on the page.</p>\n<p>Follow the sample code for the Konva <a href=\"https://konvajs.org/docs/sandbox/Free_Drawing.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">free drawing application</a>. This shows you how to create a simple free drawing application.</p>\n<p>Once you get the code working, refactor it into it's own function. You should also move a few of the variables to a global scope and move the event listener to the global scope also.</p>\n<p>You code will look similar to the following</p>\n<pre><code>var width = window.innerWidth;\nvar height = window.innerHeight - 25;\n\n// set up Konva\nvar stage;\n\nvar isPaint = false;\nvar mode = 'brush';\nvar lastLine;\n\n\nfunction initKonva() {\n      \n      stage = new Konva.Stage({\n            container: 'sketchBook',\n            width: width,\n            height: height\n        });\n\n      var layer = new Konva.Layer();\n      stage.add(layer);\n\n      stage.on('mousedown touchstart', function(e) {\n        isPaint = true;\n        var pos = stage.getPointerPosition();\n        lastLine = new Konva.Line({\n          stroke: '#df4b26',\n          strokeWidth: 5,\n          globalCompositeOperation:\n            mode === 'brush' ? 'source-over' : 'destination-out',\n          points: [pos.x, pos.y]\n        });\n        layer.add(lastLine);\n      });\n\n      stage.on('mouseup touchend', function() {\n        isPaint = false;\n      });\n\n      // and core function - drawing\n      stage.on('mousemove touchmove', function() {\n        if (!isPaint) {\n          return;\n        }\n\n        const pos = stage.getPointerPosition();\n        var newPoints = lastLine.points().concat([pos.x, pos.y]);\n        lastLine.points(newPoints);\n        layer.batchDraw();\n      });\n}\n\n// Setup Event Listeners\nvar select = document.getElementById('tool');\nselect.addEventListener('change', function() {\n  mode = select.value;\n});\n\n// Because we need to call the function\ninitKonva();\n</code></pre>\n","path":"/lab/9/3/","start":false,"last":false}},"context":{}}